Yeah, it ain't pretty. Yeah, it can be optimized. Still works, though.